<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Office Pantry Â· Choice Talk</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="app.js" defer></script>
</head>
<body>

  <!-- Audio unlock overlay -->
  <div class="overlay" id="audioOverlay">
    <div class="overlay__card">
      <div class="overlay__icon">ðŸŽ§</div>
      <h2 class="overlay__title">Office Pantry</h2>
      <p class="overlay__desc">This scene uses voice synthesis.<br>Enable audio to hear the NPC speak, or continue in read-only mode.</p>
      <div class="overlay__actions">
        <button class="btn btn--ghost" id="overlayNoAudio">Read only</button>
        <button class="btn btn--primary" id="overlayEnable">Enable Audio</button>
      </div>
      <div class="err-list" id="startupErrors"></div>
    </div>
  </div>

  <!-- Single-column page wrapper (max 640px centered) -->
  <div class="page">

    <!-- Scene bar -->
    <header class="scene-bar">
      <h1 class="scene-bar__title" id="sceneTitle">Loadingâ€¦</h1>
      <div class="scene-bar__status">
        <span class="chip" id="langChip">EN</span>
        <span class="chip" id="audioChip">Audio: off</span>
      </div>
      <div class="scene-bar__meta" id="sceneMeta"></div>
    </header>

    <!-- VN Game Screen: scene bg + dialogue + picks all in one frame -->
    <div class="vn-screen">
      <div class="scene-hero" id="bgHint"></div>
      <div id="dialogueBox" class="vn-dialogue"></div>
      <div id="pickBox" class="vn-picks" style="display:none;"></div>
    </div>

    <!-- Game panels (below the VN screen) -->
    <main class="stage" id="stage">
      <div id="feedbackBox" class="feedback-box"></div>
      <div id="recapWrap" class="recap-wrap"></div>
    </main>

    <!-- Bottom toolbar -->
    <nav class="toolbar">
      <button class="toolbar__btn" id="toggleSubsBtn" title="Toggle subtitles (T)">
        <span class="toolbar__ic">T</span><span class="toolbar__lb">Subs</span>
      </button>
      <button class="toolbar__btn" id="toggleExplainBtn" title="Toggle explanations">
        <span class="toolbar__ic">?</span><span class="toolbar__lb">Explain</span>
      </button>
      <button class="toolbar__btn" id="replayBtn" title="Replay last line (R)">
        <span class="toolbar__ic">â†»</span><span class="toolbar__lb">Replay</span>
      </button>
      <button class="toolbar__btn" id="voiceBtn" title="Voice settings (V)">
        <span class="toolbar__ic">â™ª</span><span class="toolbar__lb">Voices</span>
      </button>
      <button class="toolbar__btn toolbar__btn--danger" id="restartBtn" title="Restart scene">
        <span class="toolbar__ic">âŸ³</span><span class="toolbar__lb">Restart</span>
      </button>
    </nav>

    <!-- Collapsible voice settings drawer -->
    <div class="drawer" id="voicePanel" style="display:none;">
      <h3 class="drawer__title">Voice Settings</h3>
      <div class="drawer__field">
        <label class="drawer__label">NPC voice</label>
        <select class="drawer__select" id="npcVoiceSelect"></select>
      </div>
      <div class="drawer__field">
        <label class="drawer__label">Player voice</label>
        <select class="drawer__select" id="playerVoiceSelect"></select>
      </div>
      <div class="drawer__field">
        <label class="drawer__label">Rate <kbd class="drawer__val" id="rateLabel">1.00</kbd></label>
        <input type="range" id="rateRange" min="0.85" max="1.15" step="0.01" value="1.00" />
      </div>
      <div class="drawer__field">
        <label class="drawer__label">Pitch <kbd class="drawer__val" id="pitchLabel">1.00</kbd></label>
        <input type="range" id="pitchRange" min="0.85" max="1.15" step="0.01" value="1.00" />
      </div>
    </div>

    <!-- Hidden progress data (JS compat) -->
    <div class="sr-only" aria-hidden="true">
      <span id="nodeIdLabel">-</span>
      <span id="pickCountLabel">0</span>
      <span id="lastQualityLabel">-</span>
    </div>

    <!-- Keyboard hints -->
    <footer class="kbd-bar">
      <kbd>Space</kbd> continue Â· <kbd>1</kbd><kbd>2</kbd><kbd>3</kbd> choose Â·
      <kbd>R</kbd> replay Â· <kbd>T</kbd> subs Â· <kbd>V</kbd> voices
    </footer>

  </div>

</body>
</html>
